<!DOCTYPE html>
<html lang="en">
<style type="text/css">
.droot{
        width:auto;
        height:auto;
        background:#f5f6fa;
        justify-content: center;
        display:flex;
        align-items: center
   }
    .dsubdiv{

        width:100%;
        height: auto;
        background: #7f8fa6;
        padding: 15px;
        border-radius: 10px;

    }
    .dhead{
        font-size: 32px;
        font-weight: bold;
        letter-spacing: 2px;
        color:#FFF;
        display: flex;
        align-items: center;

   }


    .root{
        width:100%;
        height:100vh;
        background:#f5f6fa;
        justify-content: center;
        display:flex;
        align-items: center
   }
    .subdiv{

        width:auto;
        height: auto;
        background: #7f8fa6;
        padding: 15px;
        border-radius: 10px;

    }
    .head{

        font-size: 32px;
        font-weight: bold;
        justify-content: center;
        display:flex;
        color:#fff;
        padding-bottom:20px;

   }


   .tbtexthead{
       color: #FFFFFF;
       font-weight: bolder;
       font-size: 24px;
   }
 .tbtext{
       color: #FFFFFF;
       font-weight: bold;
       font-size: 18px;
      }

</style>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Doctor Registration</title>
<!-- Font Awesome -->
<link
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
  rel="stylesheet"
/>
<!-- Google Fonts -->
<link
  href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
  rel="stylesheet"
/>
<!-- MDB -->
<link
  href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.10.2/mdb.min.css"
  rel="stylesheet"
/>
    <script
  type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.10.2/mdb.min.js"
></script>

<script src = "https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
 <script src="/static/project.js"></script>
</head>
<body>
<div class="root">
<div class="subdiv">
    <center>
<div class="head"  >
       Doctor's Registration
</div>
        </center>
<table class="table align-middle">
  <thead class="tbtexthead">
    <tr>

      <th scope="col">ID</th>
      <th scope="col">DName</th>
      <th scope="col">DOB</th>
      <th scope="col">Gender</th>
        <th scope="col">EmailAddress</th>
      <th scope="col">Specialization</th>
      <th scope="col">Mobile </th>
      <th scope="col">Icon</th>
          <th scope="col">Update</th>
    </tr>
  </thead>
  <tbody class="tbtext">

{% for row in result %}
    <tr>
    <th scope="row">{{row.doctorid}}</th>
    <td>{{ row.doctorname }}</td>
        <td>{{ row.dob }}</td>
         <td>{{ row.gender }}</td>
         <td>{{ row.emailaddress }}</td>
         <td>{{ row.tspecialization }}</td>
         <td>{{ row.mobileno }}</td>

         <td>
                    <button type="button"
                            doctorid={{ row.doctorid }} iconspl={{ row.icon }}
                            class="btnicon btn-light btn-sm px-3" data-mdb-toggle="modal"
                            data-mdb-target="#iconModal">
                        <img
                                src="/static/{{ row.icon }}"
                                class="img-fluid rounded"
                                syyle="width:100px;"

                        />
                    </button>


                </td>

        <td>
            <button type="button"
                            doctorid={{ row.doctorid }} doctorname='{{row.doctorname}}' d={{row.dob}}  gender='{{row.gender}}' emailaddress={{row.emailaddress}} specialization={{row.specialization}} tspl="{{row.tspecialization}}" mobileno={{row.mobileno}}
                            class="btnedit btn-light btn-sm px-3" data-mdb-toggle="modal"
                            data-mdb-target="#exampleModal">
                        <i class="fas fa-edit"></i>
                    </button>

    </td>
    </tr>
{% endfor %}



  </tbody>
</table>
</div>
</div>
<!-- Modal -->
 <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
   <div class="modal-dialog modal-dialog-centered">
     <div class="modal-content">
       <div class="modal-header">
         <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
         <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
       </div>
       <div class="modal-body">


 <div class="droot">
    <div class="dsubdiv">
        <div class="dhead">
            <span ><img src="/static/logo.png" width="120"></span>
            <span style="padding-left: 10px">Doctor Registration</span>
        </div>

         <div class="row" style="margin-top: 8px">
            <div class="col-12">
                <div class="form-outline form-white" >
                   <input type="text" name="doctorid" id="did" class="form-control form-control-lg" />
                     <label class="form-label" for="did">Doctor Id </label>

                </div>
            </div>
       </div>
         <div class="row" style="margin-top: 8px">
            <div class="col-12">
                <div class="form-outline form-white" >
                   <input type="text" name="doctorname" id="dname" class="form-control form-control-lg" />
                     <label class="form-label" for="dname">Doctor Name </label>

                </div>
            </div>
       </div>
        <div class="row" style="margin-top: 8px">
            <div class="col-12">
                <div class="form-outline form-white" >
                   <input type="text" name="dob" id="d" class="form-control form-control-lg" />
                     <label class="form-label" for="d">Date of Birth </label>

                </div>
            </div>
       </div>
       <div class="row" style="margin-top: 8px">
            <div class="col-12">
                <div class="form-outline form-white" >
                   <input type="text" name="gender" id="gen" class="form-control form-control-lg" />
                     <label class="form-label" for="gen">Gender </label>

                </div>
            </div>
       </div>

         <div class="row" style="margin-top: 8px">
            <div class="col-12">
                <div class="form-outline form-white" >
                   <input type="text" name="emailaddress" id="mail" class="form-control form-control-lg" />
                     <label class="form-label" for="mail">Email Address </label>

                </div>
            </div>
       </div>
        <div class="row" style="margin-top: 8px">
            <div class="col-12">
                <div class="form-outline form-white" >
                   <input type="text" name="mobileno" id="mob" class="form-control form-control-lg" />
                     <label class="form-label" for="mob">Mobile Number </label>

                </div>
            </div>
       </div>

        <div class="row" style="margin-top: 8px">
            <div class="col-12">
                  <div class="form-outline form-white">
                    <select id="spl" name="specialization" class="form-select">
                     <option value="{{row.specialization}}"> {{row.tspecialization}}</option>
                    </select>
                    </select>
                </div>

            </div>
       </div>





        <div class="row" style="margin-top: 10px">
            <div class="col-6">
             <button type="button" style="width:100%" class="updbtn btn-light btn-lg" data-mdb-ripple-color="dark">UPDATE RECORDS</button>

            </div>
             <div class="col-6">
             <button type="button" style="width:100%" class="delbtn btn-light btn-lg" data-mdb-ripple-color="dark">DELETE RECORD</button>

            </div>
        </div>
        <div class="row" style="margin-top: 4px">
            <div style="text-align:center;color: #FFF;font-size: 18px" id="msg" class="col-12">

            </div>
         </div>

    </div>
 </div>



       </div>

     </div>
   </div>
</div>

<-- modal for picture -->
 <div class="modal fade" id="iconModal" tabindex="-1" aria-labelledby="iconModalLabel" aria-hidden="true">
   <div class="modal-dialog modal-dialog-centered">
     <div class="modal-content">
       <div class="modal-header">
             <div class="modal-title dhead" id="iconModalLabel">
                    <span><img src="/static/logo.png" width="80"></span>
                    <span style="padding-left: 10px; font-weight:bold;color:#353b48;">Doctor Register</span>
                </div>
                <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
            </div>
          <div class="modal-body" style="display:flex;justify-content: center; align-items: center;">
                <div class="droot">
                    <div class="dsubdiv">
                          <div class="row" style="margin-top: 8px">
            <div class="col-12">
                <div class="form-outline form-white" >
                   <input type="text" name="doctorid" id="idspl" class="form-control form-control-lg" />
                     <label class="form-label" for="idspl">Doctor Id </label>

                </div>
            </div>
       </div>
      <div class="row" style="margin-top: 10px ">
                            <div class="col-6">

                                <img
                                        id="splicon"
                                        class="rounded-3"
                                        style="width: 200px;"
                                        alt="Avatar"
                                /></div>
                            <div class="col-6" style="display:flex;justify-content: center; align-items: center;">

                                <img
                                        src="/static/edit.png"
                                        id="editicon"
                                        class="rounded-3"
                                        style="width: 150px;"
                                        alt="Avatar"
                                />
                            </div>
                        </div>

                <div class="row" style="margin-top: 10px">
                            <div class="col-12">
                                <input name="icon" class="form-control form-white form-control-lg" id="icon"
                                       type="file"/>

                            </div>
                        </div>
          <div class="row" style="margin-top: 10px">
                            <div class="col-12">
                                <button type="button" style="width:100%" class="updiconbtn btn-light btn-lg"
                                        data-mdb-ripple-color="dark">Update Icon
                                </button>
                            </div>
                        </div>


                        <div class="row" style="margin-top: 4px">
                            <div style="text-align: center; color:#FFF ;font-size: 18px" id="iconmsg" class="col-12">

                            </div>



     </div>
   </div>
 </div>
 </div>
     </div>
   </div>
 </div>



<script>
$('.btnedit').click(function(){


$('#exampleModal').modal('show');
$('#did').val($(this).attr('doctorid'))
$('#dname').val($(this).attr('doctorname'))
$('#d').val($(this).attr('dob'))
$('#gen').val($(this).attr('gender'))
$('#mail').val($(this).attr('emailaddress'))
$('#specilization').append($('<option>').text('tspl').val()
$('#mob').val($(this).attr('mobileno'))

})

$('.updbtn').click(function(){
   $.getJSON('/updatedregistration',{'doctorid':$('#did').val(),'doctorname':$('#dname').val(),'dob':$('#d').val(),'gender':$('#gen').val(),'emailaddress':$('#mail').val(),'specialization':$('#spli').val(),'mobileno':$('#mob').val()} ,function(data)
{
  if(data.result)
  {
  $('#msg').html("Record Updated Successfully")}
  else
  {
  $('#msg').html("Fail to Update Record")}
})

})

$('.delbtn').click(function(){
   $.getJSON('/deletedregistration',{'doctorid':$('#did').val(),'doctorname':$('#dname').val(),'dob':$('#d').val(),'gender':$('#gen').val(),'emailaddress':$('#mail').val(),'specialization':$('#spli').val(),'mobileno':$('#mob').val()} ,function(data)
{
  if(data.result)
  {
  $('#msg').html("Record Deleted Successfully")}
  else
  {
  $('#msg').html("Fail to Deleted Record")}
})

})
$('.btn-close').click(function () {
        location.href = "http://localhost:8000/dregistrationdisplayall"
    })


 $('.btnicon').click(function () {
 $('#exampleModal').modal('hide');
 $('#iconModal').modal('show');
 $('#idspl').val($(this).attr('doctorid'))
 $('#splicon').attr('src','/static/'+$(this).attr('iconspl'))

            })

$('#icon').change(function (event) {
 $('#editicon').attr("src",URL.createObjectURL(event.target.files[0]))
})

$('.updiconbtn').click(function (e) {

        var formData = new FormData();
        formData.append("doctorid",$('#idspl').val())
        var files = $('#icon')[0].files;

        // Check file selected or not
        if(files.length > 0 ){
           formData.append('icon',files[0]);

           $.ajax({
              url: '/editdregistrationpicture',
              type: 'post',
              headers:{
        "X-CSRFToken": '{{ csrf_token }}'
         },
              data: formData,
              contentType: false,
              processData: false,
              success: function(response){
                 if(response != 0){
                      if (response.result) {
                $('#iconmsg').html("ICON Updated Successfully")
            } else {
                $('#iconmsg').html("Fail to Update ICON...")
            }

                       }else{
                    alert('file not uploaded');
                 }
              },
           });
        }else{
           alert("Please select a file.");
        }




  })



</script>

</body>
<!-- MDB -->
<script
  type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.10.2/mdb.min.js"
></script>
</html>


